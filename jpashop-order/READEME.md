주문 서비스의 주문과 주문 취소 메서드를 보면 비즈니스 로직 대부분이 엔티티에 있다. 서비스 계층은 단순히 엔티티에 필요한 요청을 위임하는 역할을 한다. 이처럼 엔티티가 비즈니스 로직을 가지고 객체 지향의 특성을 적극 활요하는 것을 도메인 모델 패턴(http://martinfowler.com/eaaCatalog/domainModel.html)이라 한다. 반대로 엔티티에는 비즈니스 로직이 거의 없고 서비스 계층에서 대부분의 비즈니스 로직을 처리하는 것을 트랜잭션 스크린트 패턴(http://martinfowler.com/eaaCatalog/transactionScript.html)이라 한다.

## 변경감지와 병합(merge)

*준영속 엔티티*
영속성 컨텍스트가 더는 관리하지 않는 엔티티를 말한다.
(여기서는 `itemService.saveItem(book)`에서 수정을 시도하는 `Book`객체다. `Book`객체는 이미 DB에 한번 저장되어서 식별자가 존재한다. 이렇게 임의로 만들어낸 엔티티도 기존 식별자를 가지고 있으면 준영속 엔티티로 볼 수 있다.)

*준영속 엔티티를 수정하는 2가지 방법*
- 변경 감지 기능 사용
- 병합(merge) 사용
주의: 변경 감지 기능을 사용하면 원하는 속성만 선택해서 변경할 수 있지만, 병합을 사용하면 모든 속성이 변경된다. 병합시 값이 없으면 `null`로 업데이트 할 위험도 있다.(병합은 모든 필드를 교체한다.)
**엔티티를 변경할 때는 항상 변경 감지를 사용하세요!**

